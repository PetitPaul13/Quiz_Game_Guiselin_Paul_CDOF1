# Définition des questions du quiz
questions = [
    {
        "question": "Quel empereur romain a légalisé le christianisme dans l'Empire romain ?",
        "choices": ["A) Néron", "B) Auguste", "C) Constantin", "D) Trajan"],
        "answer": "C"
    },
    {
        "question": "Quelle est la plus ancienne civilisation connue dans le monde ?",
        "choices": ["A) Égyptienne", "B) Mésopotamienne", "C) Indus", "D) Chinoise"],
        "answer": "B"
    },
    {
        "question": "Qui a découvert l'Amérique en 1492 ?",
        "choices": ["A) Marco Polo", "B) Christophe Colomb", "C) Leif Erikson", "D) Vasco de Gama"],
        "answer": "B"
    },
    {
        "question": "Quelle guerre s'est terminée par le Traité de Versailles en 1919 ?",
        "choices": ["A) La Première Guerre mondiale", "B) La Guerre de Trente Ans", "C) La Guerre de Sept Ans", "D) La Seconde Guerre mondiale"],
        "answer": "A"
    },
    {
        "question": "Quel roi d'Angleterre a signé la Magna Carta en 1215 ?",
        "choices": ["A) Richard Cœur de Lion", "B) Henri VIII", "C) Jean sans Terre", "D) Édouard Ier"],
        "answer": "C"
    },
    {
        "question": "Dans quelle ville la Révolution russe de 1917 a-t-elle commencé ?",
        "choices": ["A) Moscou", "B) Saint-Pétersbourg", "C) Kiev", "D) Kazan"],
        "answer": "B"
    },
    {
        "question": "Qui était le commandant des forces alliées en Europe pendant la Seconde Guerre mondiale ?",
        "choices": ["A) Dwight D. Eisenhower", "B) Bernard Montgomery", "C) George S. Patton", "D) Douglas MacArthur"],
        "answer": "A"
    },
    {
        "question": "Quelle est la plus ancienne civilisation connue dans le monde ?",
        "choices": ["A) Douglas MacArthur", "B) George S. Patton", "C) Dwight D. Eisenhower", "D) Bernard Montgomery"],
        "answer": "C"
    },
    {
        "question": "Quel dirigeant a mis en œuvre la politique de la Grande Terreur en Union Soviétique ?",
        "choices": ["A) Lénine", "B) Staline", "C) Khrouchtchev", "D) Brejnev"],
        "answer": "B"
    },
    {
        "question": "Qui était le président des États-Unis pendant la guerre civile américaine ?",
        "choices": ["A) Thomas Jefferson", "B) Andrew Jackson", "C) Abraham Lincoln", "D) Ulysses S. Grant"],
        "answer": "C"
    },
    {
        "question": "Quel événement a marqué le début de l'Antiquité ?",
        "choices": ["A) La chute de l'Empire romain", "B) La construction des pyramides", "C) L'invention de l'écriture", "D) La naissance de Jules César"],
        "answer": "C"
    },
    {
        "question": "Quelle dynastie a régné sur la Chine pendant le plus longtemps ?",
        "choices": ["A) Qing", "B) Ming", "C) Han", "D) Zhou"],
        "answer": "B"
    },
    {
        "question": "Quelle reine a régné sur l'Empire britannique à son apogée territoriale ?",
        "choices": ["A) Élisabeth I", "B) Victoria", "C) Marie I", "D) Anne"],
        "answer": "B"
    },
    {
        "question": "Où la Déclaration des droits de l'homme et du citoyen a-t-elle été rédigée ?",
        "choices": ["A) En Angleterre", "B) Aux États-Unis", "C) En France", "D) En Allemagne"],
        "answer": "C"
    },
    {
        "question": "Qui était le chef des armées françaises pendant la Première Guerre mondiale ?",
        "choices": ["A) Charles de Gaulle", "B) Ferdinand Foch", "C) Philippe Pétain", "D) Georges Clemenceau"],
        "answer": "B"
    },
    {
        "question": "Quel événement historique est associé à la date du 14 juillet 1789 ?",
        "choices": ["A) La déclaration d'indépendance américaine", "B) La prise de la Bastille", "C) Le début de la Première Guerre mondiale", "D) L'assassinat de l'archiduc François-Ferdinand"],
        "answer": "B"
    },
    {
        "question": "Quelle invention est souvent considérée comme le début de la Révolution industrielle ?",
        "choices": ["A) La locomotive à vapeur", "B) La machine à tisser", "C) La machine à vapeur", "D) L'imprimerie"],
        "answer": "C"
    },
    {
        "question": "Quel dirigeant a initié la politique de Réforme en URSS dans les années 1980 ?",
        "choices": ["A) Léonid Brejnev", "B) Mikhaïl Gorbatchev", "C) Boris Eltsine", "D) Nikita Khrouchtchev"],
        "answer": "B"
    },
    {
        "question": "Dans quelle ville italienne le traité de paix mettant fin à la Guerre de Succession d'Espagne a-t-il été signé en 1713 ?",
        "choices": ["A) Rome", "B) Milan", "C) Venise", "D) Utrecht"],
        "answer": "D"
    },
    {
        "question": "Quel explorateur est connu pour avoir complété le premier tour du monde en bateau ?",
        "choices": ["A) Christophe Colomb", "B) James Cook", "C) Ferdinand Magellan", "D) Marco Polo"],
        "answer": "C"
    },
    {
        "question": "Quelle bataille de la Guerre de Sécession américaine a été le tournant de la guerre ?",
        "choices": ["A) Bataille d'Antietam", "B) Bataille de Gettysburg", "C) Bataille de Bull Run", "D) Bataille de Vicksburg"],
        "answer": "B"
    },
    {
        "question": "Qui était le premier président des États-Unis ?",
        "choices": ["A) Thomas Jefferson", "B) George Washington", "C) John Adams", "D) Abraham Lincoln"],
        "answer": "B"
    },
    {
        "question": "Quel célèbre dirigeant de la Révolution cubaine a renversé le gouvernement en 1959 ?",
        "choices": ["A) Che Guevara", "B) Fidel Castro", "C) Raul Castro", "D) Fulgencio Batista"],
        "answer": "B"
    },
    {
        "question": "Quel événement historique est associé à la date du 4 juillet 1776 ?",
        "choices": ["A) La déclaration d'indépendance américaine", "B) La bataille de Lexington et Concord", "C) L'adoption de la Constitution des États-Unis", "D) La fin de la Guerre d'Indépendance américaine"],
        "answer": "A"
    },
    {
        "question": "Qui était le premier homme à marcher sur la Lune en 1969 ?",
        "choices": ["A) John Glenn", "B) Alan Shepard", "C) Neil Armstrong", "D) Buzz Aldrin"],
        "answer": "C"
    },
    {
        "question": "Quelle reine d'Égypte est célèbre pour sa liaison avec Marc Antoine et Jules César ?",
        "choices": ["A) Néfertiti", "B) Cléopâtre", "C) Hatchepsout", "D) Arsinoé II"],
        "answer": "B"
    },
    {
        "question": "Quelle était la dynastie au pouvoir lors de la construction de la Grande Muraille de Chine ?",
        "choices": ["A) Han", "B) Zhou", "C) Qin", "D) Tang"],
        "answer": "C"
    },
    {
        "question": "Qui était le fondateur de la dynastie mongole qui a établi l'Empire mongol au 13ème siècle ?",
        "choices": ["A) Genghis Khan", "B) Kubilai Khan", "C) Tamerlan", "D) Attila le Hun"],
        "answer": "A"
    },
    {
        "question": "Quel explorateur portugais a ouvert la voie aux voyages de découverte au 15ème siècle en atteignant l'Inde par voie maritime ?",
        "choices": ["A) Marco Polo", "B) Vasco de Gama", "C) Christophe Colomb", "D) Ferdinand Magellan"],
        "answer": "B"
    },
    {
        "question": "Quel empereur romain est célèbre pour avoir ordonné la construction du mur d'Hadrien en Grande-Bretagne ?",
        "choices": ["A) Auguste", "B) Trajan", "C) Hadrien", "D) Caligula"],
        "answer": "C"
    },
    {
        "question": "Quel événement a marqué le début de la Révolution française en 1789 ?",
        "choices": ["A) L'exécution de Louis XVI", "B) La prise de la Bastille", "C) La Révolution de Juillet", "D) La Convention nationale"],
        "answer": "B"
    },
    {
        "question": "Qui était le fondateur de l'empire mongol au 12ème siècle ?",
        "choices": ["A) Genghis Khan", "B) Kubilai Khan", "C) Tamerlan", "D) Attila le Hun"],
        "answer": "A"
    },
    {
        "question": "Quel explorateur a découvert l'Amérique en 1492 sous le patronage de l'Espagne ?",
        "choices": ["A) Marco Polo", "B) Christophe Colomb", "C) Leif Erikson", "D) Vasco de Gama"],
        "answer": "B"
    },
    {
        "question": "Dans quelle ville allemande le mur de Berlin a-t-il été érigé en 1961 ?",
        "choices": ["A) Hambourg", "B) Francfort", "C) Berlin", "D) Munich"],
        "answer": "C"
    },
    {
        "question": "Quel empereur romain est connu pour avoir réalisé des réformes importantes et le Code Justinien ?",
        "choices": ["A) Auguste", "B) Trajan", "C) Constantin", "D) Justinien Ier"],
        "answer": "D"
    },
    {
        "question": "Qui était la célèbre infirmière britannique qui a servi pendant la Guerre de Crimée et a fondé la profession d'infirmière moderne ?",
        "choices": ["A) Florence Nightingale", "B) Clara Barton", "C) Mary Seacole", "D) Agnes Jones"],
        "answer": "A"
    },
    {
        "question": "Quel empereur romain a été assassiné en 44 av. J.-C. lors des Ides de Mars ?",
        "choices": ["A) Auguste", "B) Caligula", "C) Marc Aurèle", "D) Jules César"],
        "answer": "D"
    },
    {
        "question": "Quel philosophe grec est considéré comme le père de la philosophie occidentale et a enseigné à son élève Platon ?",
        "choices": ["A) Aristote", "B) Socrate", "C) Pythagore", "D) Héraclite"],
        "answer": "B"
    },
    {
        "question": "Quelle guerre a opposé les États-Unis et le Mexique dans les années 1840 ?",
        "choices": ["A) La guerre d'indépendance du Mexique", "B) La guerre hispano-américaine", "C) La guerre américano-mexicaine", "D) La guerre des Contras"],
        "answer": "C"
    }
]

import tkinter as tk
from tkinter import messagebox
import random

class Question:
    def __init__(self, question, choices, answer):
        self.question = question
        self.choices = choices
        self.answer = answer

class Quiz:
    def __init__(self, questions, time_limit):
        self.questions = [Question(**q) for q in questions]
        random.shuffle(self.questions)
        self.questions = self.questions[:20]
        self.score = 0
        self.current_question = 0
        self.time_limit = time_limit  # in seconds


    def check_answer(self, answer):
        if self.questions[self.current_question].answer == answer:
            self.score += 1
        self.current_question += 1

    def has_next_question(self):
        return self.current_question < len(self.questions)

    def get_next_question(self):
        if self.has_next_question():
            return self.questions[self.current_question]
        return None

class QuizGUI:
    def __init__(self, quiz, time_limit):
            self.quiz = quiz
            self.time_limit = time_limit  # store the time limit
            self.root = tk.Tk()
            self.root.title("Jeu de Quiz Historique")
            self.question_number_label = tk.Label(self.root)
            self.question_number_label.pack()
            self.score_label = tk.Label(self.root)
            self.score_label.pack()
            self.time_label = tk.Label(self.root)  # new label to display the remaining time
            self.time_label.pack()
            self.timer_id = None  # new attribute to store the countdown timer ID
            self.display_next_question()

    def display_next_question(self):
        self.question_number_label.config(text=f"Question: {self.quiz.current_question + 1}/{len(self.quiz.questions)}")
        self.score_label.config(text=f"Score: {self.quiz.score}/{len(self.quiz.questions)}")
        if self.quiz.has_next_question():
            question = self.quiz.get_next_question()
            self.display_question(question.question, question.choices, question.answer)
        else:
            messagebox.showinfo("Fin du Quiz", f"Votre score final est {self.quiz.score} sur {len(self.quiz.questions)}.")
            self.display_replay_button()

    def display_replay_button(self):
        for widget in self.root.winfo_children():
            if widget != self.question_number_label and widget != self.score_label:
                widget.destroy()
        tk.Button(self.root, text="Replay", command=self.replay).pack()

    def replay(self):
        self.quiz = Quiz(questions, self.time_limit)  # use the stored time limit
        self.display_next_question()

    def display_question(self, question, options, answer):
            for widget in self.root.winfo_children():
                if widget not in [self.question_number_label, self.score_label, self.time_label]:
                    widget.destroy()
            tk.Label(self.root, text=question).pack()
            var = tk.StringVar(value="L")
            for option in options:
                tk.Radiobutton(self.root, text=option, variable=var, value=option.split(')')[0]).pack()
            tk.Button(self.root, text="Valider", command=lambda: self.check_answer(var.get())).pack()
            if self.timer_id is not None:
                self.root.after_cancel(self.timer_id)  # cancel the previous countdown
            self.start_countdown(self.quiz.time_limit)  # start the countdown

    def start_countdown(self, time_left):
            if not self.quiz.has_next_question():
                return
            if time_left > 0:
                self.time_label.config(text=f"Time left: {time_left} seconds")
                self.timer_id = self.root.after(1000, self.start_countdown, time_left - 1)  # store the countdown timer ID
            else:
                self.time_label.config(text="Time's up!")
                self.check_answer('')  # mark the current question as incorrect

    def check_answer(self, answer):
        self.quiz.check_answer(answer)
        self.display_next_question()

    def run(self):
        self.root.mainloop()

# Initialize the quiz with the questions
quiz = Quiz(questions, 5)
# Initialize the GUI with the quiz and the time limit
gui = QuizGUI(quiz, 5)
# Run the GUI
gui.run()
